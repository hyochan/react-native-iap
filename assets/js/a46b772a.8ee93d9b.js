"use strict";(self.webpackChunkreact_native_iap_docs=self.webpackChunkreact_native_iap_docs||[]).push([[9309],{27856:(e,n,i)=>{i.d(n,{I:()=>s,V:()=>r});const r="https://iapkit.com",s="https://www.hyo.dev/api/ad-banner/cmjf0l2460003249hfyh029dm"},28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>a});var r=i(96540);const s={},t=r.createContext(s);function o(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(t.Provider,{value:n},e.children)}},35159:(e,n,i)=>{i.d(n,{A:()=>a});var r=i(96540),s=i(86025),t=i(27856),o=i(74848);function a({className:e="iapkit-banner",style:n}){const i=(0,s.Ay)("/img/iapkit-banner.gif"),a=(0,r.useCallback)(e=>{fetch(t.I,{method:"POST",mode:"no-cors"}).catch(()=>{})},[]);return(0,o.jsx)("div",{className:e,style:{marginTop:0,marginBottom:12,textAlign:"center",...n},children:(0,o.jsx)("a",{href:t.V,target:"_blank",rel:"noopener noreferrer",onClick:a,style:{display:"inline-block",textDecoration:"none"},children:(0,o.jsx)("img",{src:i,alt:"IapKit - In-App Purchase Validation Service",style:{border:"none",display:"block"}})})})}},52017:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>u,frontMatter:()=>c,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"api/methods/core-methods","title":"Core Methods","description":"This section covers the core methods available in react-native-iap for managing in-app purchases.","source":"@site/versioned_docs/version-14.6/api/methods/core-methods.md","sourceDirName":"api/methods","slug":"/api/methods/core-methods","permalink":"/react-native-iap/docs/14.6/api/methods/core-methods","draft":false,"unlisted":false,"editUrl":"https://github.com/hyochan/react-native-iap/tree/main/docs/versioned_docs/version-14.6/api/methods/core-methods.md","tags":[],"version":"14.6","sidebarPosition":1,"frontMatter":{"title":"Core Methods","sidebar_label":"Core Methods","sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"useIAP Hook","permalink":"/react-native-iap/docs/14.6/api/use-iap"},"next":{"title":"Listeners","permalink":"/react-native-iap/docs/14.6/api/methods/listeners"}}');var s=i(74848),t=i(28453),o=i(35159),a=i(71437);const c={title:"Core Methods",sidebar_label:"Core Methods",sidebar_position:1},l="Core Methods",d={},h=[{value:"Unified APIs",id:"unified-apis",level:2},{value:"initConnection()",id:"initconnection",level:2},{value:"endConnection()",id:"endconnection",level:2},{value:"fetchProducts()",id:"fetchproducts",level:2},{value:"requestPurchase()",id:"requestpurchase",level:2},{value:"Recommended usage with useIAP hook (Recommended)",id:"recommended-usage-with-useiap-hook-recommended",level:3},{value:"Direct API usage (Advanced)",id:"direct-api-usage-advanced",level:3},{value:"Detailed Platform Examples",id:"detailed-platform-examples",level:3},{value:"iOS Only",id:"ios-only",level:4},{value:"Android Only",id:"android-only",level:4},{value:"Important Subscription Properties",id:"important-subscription-properties",level:4},{value:"finishTransaction()",id:"finishtransaction",level:2},{value:"getAvailablePurchases()",id:"getavailablepurchases",level:2},{value:"deepLinkToSubscriptions()",id:"deeplinktosubscriptions",level:2},{value:"getStorefront()",id:"getstorefront",level:2},{value:"getActiveSubscriptions()",id:"getactivesubscriptions",level:2},{value:"hasActiveSubscriptions()",id:"hasactivesubscriptions",level:2},{value:"verifyPurchase()",id:"verifypurchase",level:2},{value:"verifyPurchaseWithProvider()",id:"verifypurchasewithprovider",level:2},{value:"Error Handling &amp; Purchase Identifiers",id:"error-handling--purchase-identifiers",level:3},{value:"Purchase Interface",id:"purchase-interface",level:2},{value:"Platform-specific APIs",id:"platform-specific-apis",level:2},{value:"iOS Specific",id:"ios-specific",level:3},{value:"clearTransactionIOS()",id:"cleartransactionios",level:3},{value:"getStorefrontIOS()",id:"getstorefrontios",level:3},{value:"getPromotedProductIOS()",id:"getpromotedproductios",level:3},{value:"requestPurchaseOnPromotedProductIOS()",id:"requestpurchaseonpromotedproductios",level:3},{value:"getPendingTransactionsIOS()",id:"getpendingtransactionsios",level:3},{value:"isEligibleForIntroOfferIOS()",id:"iseligibleforintroofferios",level:3},{value:"subscriptionStatusIOS()",id:"subscriptionstatusios",level:3},{value:"currentEntitlementIOS()",id:"currententitlementios",level:3},{value:"latestTransactionIOS()",id:"latesttransactionios",level:3},{value:"showManageSubscriptionsIOS()",id:"showmanagesubscriptionsios",level:3},{value:"beginRefundRequestIOS()",id:"beginrefundrequestios",level:3},{value:"isTransactionVerifiedIOS()",id:"istransactionverifiedios",level:3},{value:"getTransactionJwsIOS()",id:"gettransactionjwsios",level:3},{value:"getReceiptDataIOS()",id:"getreceiptdataios",level:3},{value:"syncIOS()",id:"syncios",level:3},{value:"presentCodeRedemptionSheetIOS()",id:"presentcoderedemptionsheetios",level:3},{value:"getAppTransactionIOS()",id:"getapptransactionios",level:3},{value:"Android Specific",id:"android-specific",level:3},{value:"acknowledgePurchaseAndroid",id:"acknowledgepurchaseandroid",level:4},{value:"consumePurchaseAndroid",id:"consumepurchaseandroid",level:4},{value:"flushFailedPurchasesCachedAsPendingAndroid (Removed)",id:"flushfailedpurchasescachedaspendingandroid-removed",level:4},{value:"Alternative Billing APIs",id:"alternative-billing-apis",level:2},{value:"Billing Programs API (Android 8.2.0+) - Recommended",id:"billing-programs-api-android-820---recommended",level:3},{value:"enableBillingProgramAndroid()",id:"enablebillingprogramandroid",level:4},{value:"isBillingProgramAvailableAndroid()",id:"isbillingprogramavailableandroid",level:4},{value:"createBillingProgramReportingDetailsAndroid()",id:"createbillingprogramreportingdetailsandroid",level:4},{value:"launchExternalLinkAndroid()",id:"launchexternallinkandroid",level:4},{value:"Complete Billing Programs Flow",id:"complete-billing-programs-flow",level:4},{value:"Legacy Alternative Billing APIs (Pre-8.2.0)",id:"legacy-alternative-billing-apis-pre-820",level:3},{value:"Android Alternative Billing (Legacy)",id:"android-alternative-billing-legacy",level:3},{value:"Initialize with Alternative Billing",id:"initialize-with-alternative-billing",level:4},{value:"checkAlternativeBillingAvailabilityAndroid()",id:"checkalternativebillingavailabilityandroid",level:4},{value:"showAlternativeBillingDialogAndroid()",id:"showalternativebillingdialogandroid",level:4},{value:"createAlternativeBillingTokenAndroid()",id:"createalternativebillingtokenandroid",level:4},{value:"Complete Alternative Billing Flow (Android)",id:"complete-alternative-billing-flow-android",level:4},{value:"iOS External Purchase",id:"ios-external-purchase",level:3},{value:"canPresentExternalPurchaseNoticeIOS()",id:"canpresentexternalpurchasenoticeios",level:4},{value:"presentExternalPurchaseNoticeSheetIOS()",id:"presentexternalpurchasenoticesheetios",level:4},{value:"presentExternalPurchaseLinkIOS()",id:"presentexternalpurchaselinkios",level:4},{value:"iOS Configuration",id:"ios-configuration",level:4},{value:"Removed APIs",id:"removed-apis",level:2}];function p(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"core-methods",children:"Core Methods"})}),"\n",(0,s.jsx)(o.A,{}),"\n",(0,s.jsx)(n.p,{children:"This section covers the core methods available in react-native-iap for managing in-app purchases."}),"\n",(0,s.jsx)(n.p,{children:"Note: react-native-iap aligns with the OpenIAP API surface. For canonical cross-SDK API docs, see:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.openiap.dev/docs/apis",children:"OpenIAP APIs"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"unified-apis",children:"Unified APIs"}),"\n",(0,s.jsx)(n.p,{children:"These cross\u2011platform methods work on both iOS and Android. For StoreKit/Play\u2011specific helpers, see the Platform\u2011specific APIs section below."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#initconnection",children:(0,s.jsx)(n.code,{children:"initConnection()"})})," \u2014 Initialize the store connection"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#endconnection",children:(0,s.jsx)(n.code,{children:"endConnection()"})})," \u2014 End the store connection and cleanup"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#fetchproducts",children:(0,s.jsx)(n.code,{children:"fetchProducts()"})})," \u2014 Fetch product and subscription metadata"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#requestpurchase",children:(0,s.jsx)(n.code,{children:"requestPurchase()"})})," \u2014 Start a purchase for products or subscriptions"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#finishtransaction",children:(0,s.jsx)(n.code,{children:"finishTransaction()"})})," \u2014 Complete a transaction after validation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#getavailablepurchases",children:(0,s.jsx)(n.code,{children:"getAvailablePurchases()"})})," \u2014 Restore non\u2011consumables and subscriptions"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#deeplinktosubscriptions",children:(0,s.jsx)(n.code,{children:"deepLinkToSubscriptions()"})})," \u2014 Open native subscription management UI"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#getstorefront",children:(0,s.jsx)(n.code,{children:"getStorefront()"})})," \u2014 Get current storefront country code"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#hasactivesubscriptions",children:(0,s.jsx)(n.code,{children:"hasActiveSubscriptions()"})})," \u2014 Check if user has active subscriptions"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#verifypurchasewithprovider",children:(0,s.jsx)(n.code,{children:"verifyPurchaseWithProvider()"})})," \u2014 Verify purchases with external providers (e.g., IAPKit)"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"initconnection",children:"initConnection()"}),"\n",(0,s.jsx)(n.p,{children:"Initializes the connection to the store. This method must be called before any other store operations."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {initConnection} from 'react-native-iap';\n\nconst initialize = async () => {\n  try {\n    await initConnection();\n    console.log('Store connection initialized');\n  } catch (error) {\n    console.error('Failed to initialize connection:', error);\n  }\n};\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<boolean>"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," When using the ",(0,s.jsx)(n.code,{children:"useIAP"})," hook, connection is automatically managed."]}),"\n",(0,s.jsx)(n.h2,{id:"endconnection",children:"endConnection()"}),"\n",(0,s.jsx)(n.p,{children:"Ends the connection to the store and cleans up resources."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {endConnection} from 'react-native-iap';\n\nconst cleanup = async () => {\n  try {\n    await endConnection();\n    console.log('Store connection ended');\n  } catch (error) {\n    console.error('Failed to end connection:', error);\n  }\n};\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<void>"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," When using the ",(0,s.jsx)(n.code,{children:"useIAP"})," hook, connection cleanup is automatic."]}),"\n",(0,s.jsx)(n.h2,{id:"fetchproducts",children:"fetchProducts()"}),"\n",(0,s.jsx)(n.p,{children:"Fetches product or subscription information from the store."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {fetchProducts} from 'react-native-iap';\n\n// Fetch in-app products\nconst loadProducts = async () => {\n  try {\n    const products = await fetchProducts({\n      skus: ['com.example.product1', 'com.example.product2'],\n      type: 'in-app',\n    });\n\n    console.log('Products:', products);\n    return products;\n  } catch (error) {\n    console.error('Failed to fetch products:', error);\n  }\n};\n\n// Fetch subscriptions\nconst loadSubscriptions = async () => {\n  try {\n    const subscriptions = await fetchProducts({\n      skus: ['com.example.premium_monthly', 'com.example.premium_yearly'],\n      type: 'subs',\n    });\n\n    console.log('Subscriptions:', subscriptions);\n    return subscriptions;\n  } catch (error) {\n    console.error('Failed to fetch subscriptions:', error);\n  }\n};\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"params"})," (object):","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"skus"})," (string[]): Array of product or subscription IDs to fetch"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"type"})," ('in-app' | 'subs'): Product type - 'in-app' for products, 'subs' for subscriptions"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<Product[]>"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"/react-native-iap/docs/14.6/api/types#product-types",children:(0,s.jsx)(n.strong,{children:"Product Type Overview"})})}),"\n",(0,s.jsx)(n.h2,{id:"requestpurchase",children:"requestPurchase()"}),"\n",(0,s.jsx)(n.p,{children:"Initiates a purchase request for products or subscriptions."}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\ud83d\udcd6 Reference:"})," ",(0,s.jsx)(n.a,{href:"https://www.openiap.dev/docs/apis#request-apis",children:"OpenIAP Request APIs"})," ",(0,s.jsx)(n.strong,{children:"\u26a0\ufe0f Platform Differences:"})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"iOS"}),": Can only purchase one product at a time (uses ",(0,s.jsx)(n.code,{children:"sku: string"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Android"}),": Can purchase multiple products at once (uses ",(0,s.jsx)(n.code,{children:"skus: string[]"}),")"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"This exists because the iOS App Store processes purchases individually, while Google Play supports batch purchases."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\ud83d\udcdd Note:"})," Both consumable and non-consumable in-app products use the same ",(0,s.jsx)(n.code,{children:"requestPurchase()"})," API with ",(0,s.jsx)(n.code,{children:"type: 'in-app'"}),". The platform handles the consumable/non-consumable behavior automatically based on your store configuration."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"recommended-usage-with-useiap-hook-recommended",children:"Recommended usage with useIAP hook (Recommended)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {useIAP} from 'react-native-iap';\n\nconst ProductPurchaseComponent = () => {\n  const {requestPurchase, products} = useIAP({\n    onPurchaseSuccess: (purchase) => {\n      console.log('Purchase successful:', purchase);\n      // Grant user access to purchased content\n      unlockProduct(purchase.productId);\n    },\n    onPurchaseError: (error) => {\n      console.error('Purchase failed:', error);\n      // Handle purchase error (user cancelled, network error, etc.)\n    },\n  });\n\n  const buyProduct = (productId: string) => {\n    requestPurchase({\n      request: {\n        ios: {\n          sku: productId,\n          quantity: 1,\n        },\n        android: {\n          skus: [productId],\n        },\n      },\n      type: 'in-app',\n    });\n    // No need to await - result handled through callbacks above\n  };\n\n  return (\n    // Your component JSX\n  );\n};\n"})}),"\n",(0,s.jsx)(n.h3,{id:"direct-api-usage-advanced",children:"Direct API usage (Advanced)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {requestPurchase} from 'react-native-iap';\n\n// Product purchase (consumable and non-consumable)\nconst buyProduct = (productId: string) => {\n  requestPurchase({\n    request: {\n      ios: {\n        sku: productId,\n        quantity: 1,\n      },\n      android: {\n        skus: [productId],\n      },\n    },\n    type: 'in-app',\n  });\n  // Purchase result is handled via purchaseUpdatedListener/purchaseErrorListener or useIAP hook callbacks (onPurchaseSuccess, onPurchaseError)\n  // See: docs/api/methods/listeners#purchaseupdatedlistener and https://hyochan.github.io/expo-iap/docs/api/methods/listeners#purchaseerrorlistener\n};\n\n// Subscription purchase\nconst buySubscription = (subscriptionId: string, subscription?: any) => {\n  requestPurchase({\n    request: {\n      ios: {\n        sku: subscriptionId,\n        appAccountToken: 'user-123',\n      },\n      google: {\n        skus: [subscriptionId],\n        subscriptionOffers:\n          subscription?.subscriptionOfferDetailsAndroid?.map((offer) => ({\n            sku: subscriptionId,\n            offerToken: offer.offerToken,\n          })) || [],\n      },\n    },\n    type: 'subs',\n  });\n  // Purchase result is handled via purchaseUpdatedListener/purchaseErrorListener or useIAP hook callbacks (onPurchaseSuccess, onPurchaseError)\n  // See: docs/api/methods/listeners#purchaseupdatedlistener and https://hyochan.github.io/expo-iap/docs/api/methods/listeners#purchaseerrorlistener\n};\n"})}),"\n",(0,s.jsx)(n.h3,{id:"detailed-platform-examples",children:"Detailed Platform Examples"}),"\n",(0,s.jsx)(n.h4,{id:"ios-only",children:"iOS Only"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"await requestPurchase({\n  request: {\n    sku: productId,\n    quantity: 1,\n    appAccountToken: 'user-account-token',\n  },\n  type: 'in-app',\n});\n"})}),"\n",(0,s.jsx)(n.h4,{id:"android-only",children:"Android Only"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"await requestPurchase({\n  request: {\n    skus: [productId],\n    obfuscatedAccountIdAndroid: 'user-account-id',\n    obfuscatedProfileIdAndroid: 'user-profile-id',\n  },\n  type: 'in-app',\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"params"})," (object):","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"request"})," (object): Purchase request configuration","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"iOS"}),": ",(0,s.jsx)(n.code,{children:"sku"})," (string) - Product ID to purchase"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Android"}),": ",(0,s.jsx)(n.code,{children:"skus"})," (string[]) - Array of product IDs to purchase"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Cross-platform"}),": Include both ",(0,s.jsx)(n.code,{children:"sku"})," and ",(0,s.jsx)(n.code,{children:"skus"})," for compatibility"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"quantity?"})," (number, iOS only): Purchase quantity"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"appAccountToken?"})," (string, iOS only): User identifier for receipt validation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"obfuscatedAccountIdAndroid?"})," (string, Android only): Obfuscated account ID"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"obfuscatedProfileIdAndroid?"})," (string, Android only): Obfuscated profile ID"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"isOfferPersonalized?"})," (boolean, Android only): Whether offer is personalized"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"type?"})," ('in-app' | 'subs'): Purchase type, defaults to 'in-app'"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<Purchase | Purchase[] | void>"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," The actual purchase result is delivered through purchase listeners or the ",(0,s.jsx)(n.code,{children:"useIAP"})," hook callbacks, not as a return value."]}),"\n",(0,s.jsx)(n.h4,{id:"important-subscription-properties",children:"Important Subscription Properties"}),"\n",(0,s.jsx)(n.p,{children:"For subscription status checks after a purchase or when listing entitlements:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["iOS: Check ",(0,s.jsx)(n.code,{children:"expirationDateIOS"})," to determine if the subscription is still active"]}),"\n",(0,s.jsxs)(n.li,{children:["Android: Check ",(0,s.jsx)(n.code,{children:"autoRenewingAndroid"})," to see if auto\u2011renewal has been canceled"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"finishtransaction",children:"finishTransaction()"}),"\n",(0,s.jsx)(n.p,{children:"Completes a purchase transaction. Must be called after successful receipt validation."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {finishTransaction} from 'react-native-iap';\n\nconst completePurchase = async (purchase) => {\n  try {\n    // Validate receipt on your server first\n    const isValid = await validateReceiptOnServer(purchase);\n\n    if (isValid) {\n      // Grant purchase to user\n      await grantPurchaseToUser(purchase);\n\n      // Finish the transaction\n      await finishTransaction({\n        purchase,\n        isConsumable: true, // Set to true for consumable products\n      });\n\n      console.log('Transaction completed');\n    }\n  } catch (error) {\n    console.error('Failed to finish transaction:', error);\n  }\n};\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"params"})," (object):","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"purchase"})," (Purchase): The purchase object to finish"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"isConsumable?"})," (boolean): Whether the product is consumable (Android)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<VoidResult | boolean>"})]}),"\n",(0,s.jsx)(n.h2,{id:"getavailablepurchases",children:"getAvailablePurchases()"}),"\n",(0,s.jsx)(n.p,{children:"Retrieves available purchases for restoration (non-consumable products and subscriptions)."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {getAvailablePurchases} from 'react-native-iap';\n\nconst restorePurchases = async () => {\n  try {\n    const purchases = await getAvailablePurchases();\n\n    for (const purchase of purchases) {\n      // Validate and restore each purchase\n      const isValid = await validateReceiptOnServer(purchase);\n      if (isValid) {\n        await grantPurchaseToUser(purchase);\n      }\n    }\n\n    console.log('Purchases restored');\n  } catch (error) {\n    console.error('Failed to restore purchases:', error);\n  }\n};\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"options?"})," (iOS only):","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"alsoPublishToEventListenerIOS?"}),": boolean"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"onlyIncludeActiveItemsIOS?"}),": boolean"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<Purchase[]>"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Platform behaviour:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"iOS"})," \u2013 the library forwards the optional flags through StoreKit\xa02. ",(0,s.jsx)(n.code,{children:"onlyIncludeActiveItemsIOS"})," defaults to ",(0,s.jsx)(n.code,{children:"true"}),", so the result only contains entitlements that are still active. Setting ",(0,s.jsx)(n.code,{children:"alsoPublishToEventListenerIOS"})," mirrors the data through the purchase event listeners for apps that subscribe directly to those callbacks."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Android"})," \u2013 Google Play separates ",(0,s.jsx)(n.code,{children:"inapp"})," (one\u2011time) and ",(0,s.jsx)(n.code,{children:"subs"})," purchases. The library internally calls the billing client twice\u2014once for each type\u2014and merges the results before running validation. No additional options are required; both product classes are returned together."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"deeplinktosubscriptions",children:"deepLinkToSubscriptions()"}),"\n",(0,s.jsx)(n.p,{children:"Opens the platform-specific subscription management UI."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {deepLinkToSubscriptions} from 'react-native-iap';\n\nconst openSubscriptionSettings = () => {\n  try {\n    deepLinkToSubscriptions({skuAndroid: 'your_subscription_sku'});\n  } catch (error) {\n    console.error('Failed to open subscription settings:', error);\n  }\n};\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<void>"})]}),"\n",(0,s.jsx)(n.h2,{id:"getstorefront",children:"getStorefront()"}),"\n",(0,s.jsx)(n.p,{children:"Return the storefront in ISO 3166-1 alpha-2 or ISO 3166-1 alpha-3 format. Works on both iOS and Android\u2014on other platforms it returns an empty string."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {getStorefront} from 'react-native-iap';\n\nconst storeFront = await getStorefront();\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<string>"})]}),"\n",(0,s.jsx)(n.h2,{id:"getactivesubscriptions",children:"getActiveSubscriptions()"}),"\n",(0,s.jsx)(n.p,{children:"Retrieves all active subscriptions with detailed status information. This method follows the OpenIAP specification for cross-platform subscription management."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {getActiveSubscriptions} from 'react-native-iap';\n\nconst checkSubscriptions = async () => {\n  try {\n    // Get all active subscriptions\n    const allActiveSubscriptions = await getActiveSubscriptions();\n\n    // Or filter by specific subscription IDs\n    const specificSubscriptions = await getActiveSubscriptions([\n      'premium_monthly',\n      'premium_yearly',\n    ]);\n\n    for (const subscription of allActiveSubscriptions) {\n      console.log('Product ID:', subscription.productId);\n      console.log('Is Active:', subscription.isActive);\n\n      if (Platform.OS === 'ios') {\n        console.log('Expiration Date:', subscription.expirationDateIOS);\n        console.log(\n          'Days until expiration:',\n          subscription.daysUntilExpirationIOS,\n        );\n        console.log('Environment:', subscription.environmentIOS);\n      } else if (Platform.OS === 'android') {\n        console.log('Auto Renewing:', subscription.autoRenewingAndroid);\n      }\n\n      console.log('Will expire soon:', subscription.willExpireSoon);\n    }\n  } catch (error) {\n    console.error('Failed to get active subscriptions:', error);\n  }\n};\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"subscriptionIds?"})," (string[]): Optional array of subscription product IDs to filter. If not provided, returns all active subscriptions."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<ActiveSubscription[]>"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"ActiveSubscription Interface:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'interface ActiveSubscription {\n  productId: string;\n  isActive: boolean;\n  transactionId: string;\n  transactionDate: number; // epoch milliseconds\n  expirationDateIOS?: number | null; // epoch milliseconds\n  daysUntilExpirationIOS?: number | null;\n  willExpireSoon?: boolean | null;\n  environmentIOS?: string | null; // "Sandbox" | "Production"\n  autoRenewingAndroid?: boolean | null;\n  purchaseToken?: string | null; // JWS (iOS) or purchaseToken (Android)\n}\n'})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["Optional properties may be ",(0,s.jsx)(n.code,{children:"undefined"})," or ",(0,s.jsx)(n.code,{children:"null"})," when the store does not provide the value (for example, ",(0,s.jsx)(n.code,{children:"expirationDateIOS"})," is only present for auto-renewing products)."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Platform Behavior:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"iOS"}),": Derived from StoreKit\xa02 entitlements. ",(0,s.jsx)(n.code,{children:"expirationDateIOS"}),", ",(0,s.jsx)(n.code,{children:"daysUntilExpirationIOS"}),", and ",(0,s.jsx)(n.code,{children:"environmentIOS"})," come directly from the latest validated transaction."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Android"}),": Derived from Google Play Billing purchases. ",(0,s.jsx)(n.code,{children:"autoRenewingAndroid"})," mirrors the Play auto-renew flag and ",(0,s.jsx)(n.code,{children:"purchaseToken"})," forwards the token you need for server-side validation."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Shared"}),": ",(0,s.jsx)(n.code,{children:"transactionId"})," and ",(0,s.jsx)(n.code,{children:"transactionDate"})," correspond to the most recent entitlement event on either platform."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"hasactivesubscriptions",children:"hasActiveSubscriptions()"}),"\n",(0,s.jsx)(n.p,{children:"Checks if the user has any active subscriptions. This is a convenience method that returns a boolean result."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {hasActiveSubscriptions} from 'react-native-iap';\n\nconst checkIfUserHasSubscription = async () => {\n  try {\n    // Check if user has any active subscriptions\n    const hasAny = await hasActiveSubscriptions();\n\n    // Or check for specific subscriptions\n    const hasPremium = await hasActiveSubscriptions([\n      'premium_monthly',\n      'premium_yearly',\n    ]);\n\n    if (hasAny) {\n      console.log('User has active subscriptions');\n    }\n\n    if (hasPremium) {\n      console.log('User has premium subscription');\n    }\n  } catch (error) {\n    console.error('Failed to check subscription status:', error);\n  }\n};\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"subscriptionIds?"})," (string[]): Optional array of subscription product IDs to check. If not provided, checks all subscriptions."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<boolean>"})," - Returns true if user has at least one active subscription"]}),"\n",(0,s.jsx)(n.h2,{id:"verifypurchase",children:"verifyPurchase()"}),"\n",(0,s.jsx)(n.p,{children:"Verifies a purchase using the native OpenIAP implementation. This validates purchases using platform-specific methods."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {verifyPurchase} from 'react-native-iap';\nimport {Platform} from 'react-native';\n\n// iOS verification (simple - just needs SKU)\nconst verifyIOS = async (sku: string) => {\n  try {\n    const result = await verifyPurchase({\n      apple: {sku},\n    });\n    console.log('iOS Verification result:', result);\n  } catch (error) {\n    console.error('Verification failed:', error);\n  }\n};\n\n// Android verification (requires additional parameters)\nconst verifyAndroid = async (purchase: Purchase) => {\n  try {\n    const result = await verifyPurchase({\n      google: {\n        sku: purchase.productId,\n        packageName: purchase.packageNameAndroid!,\n        purchaseToken: purchase.purchaseToken!,\n        accessToken: 'your-google-api-access-token',\n        isSub: false, // Set to true for subscriptions\n      },\n    });\n    console.log('Android Verification result:', result);\n  } catch (error) {\n    console.error('Verification failed:', error);\n  }\n};\n\n// Cross-platform verification\nconst verifyPurchaseCrossPlatform = async (purchase: Purchase) => {\n  try {\n    const result = await verifyPurchase({\n      apple: {sku: purchase.productId},\n      google: {\n        sku: purchase.productId,\n        packageName: purchase.packageNameAndroid ?? '',\n        purchaseToken: purchase.purchaseToken ?? '',\n        accessToken: 'your-google-api-access-token',\n        isSub: false,\n      },\n    });\n    console.log('Verification result:', result);\n  } catch (error) {\n    console.error('Verification failed:', error);\n  }\n};\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"options"})," (object): Platform-specific verification parameters","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"apple?"})," (object): Apple App Store verification options","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"sku"})," (string): Product SKU to validate"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"google?"})," (object): Google Play Store verification options","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"sku"})," (string): Product SKU to validate"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"accessToken"})," (string): Google OAuth2 access token for API authentication"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"packageName"})," (string): Android package name (e.g., ",(0,s.jsx)(n.code,{children:"com.example.app"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"purchaseToken"})," (string): Purchase token from the purchase response"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"isSub?"})," (boolean): Whether this is a subscription purchase"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"horizon?"})," (object): Meta Horizon (Quest) verification options","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"sku"})," (string): SKU for the add-on item"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"accessToken"})," (string): Meta API access token"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"userId"})," (string): User ID to verify purchase for"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<VerifyPurchaseResult>"})," - Platform-specific verification result"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Important Notes:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"iOS"}),": Only requires ",(0,s.jsx)(n.code,{children:"apple.sku"})," - verification uses StoreKit 2's built-in verification"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Android"}),": Requires all ",(0,s.jsx)(n.code,{children:"google"})," parameters - verification calls Google Play Developer API"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Horizon"}),": Requires all ",(0,s.jsx)(n.code,{children:"horizon"})," parameters - verification calls Meta's S2S verify_entitlement API"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["For external verification services with additional security, use ",(0,s.jsx)(n.a,{href:"#verifypurchasewithprovider",children:(0,s.jsx)(n.code,{children:"verifyPurchaseWithProvider()"})})," instead."]}),"\n",(0,s.jsx)(n.h2,{id:"verifypurchasewithprovider",children:"verifyPurchaseWithProvider()"}),"\n",(0,s.jsx)(n.p,{children:"Verifies purchases using external verification services like IAPKit. This provides additional validation and security beyond local device verification."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {verifyPurchaseWithProvider, finishTransaction} from 'react-native-iap';\n\ntry {\n  const result = await verifyPurchaseWithProvider({\n    provider: 'iapkit',\n    iapkit: {\n      apiKey: 'your-api-key',\n      apple: {jws: purchase.purchaseToken},\n      google: {purchaseToken: purchase.purchaseToken},\n    },\n  });\n\n  if (result.iapkit?.isValid) {\n    // Verification succeeded - grant access\n    await finishTransaction(purchase);\n    grantAccess();\n  } else {\n    // Verification failed (isValid: false) - actually invalid purchase\n    // Don't call finishTransaction - allow retry\n    denyAccess();\n  }\n} catch (error) {\n  // Verification itself failed (network, server error, etc.)\n  // This doesn't mean the purchase is invalid - don't penalize the customer\n  console.error('Verification failed:', error);\n  await finishTransaction(purchase); // Complete the transaction\n  grantAccess(); // Grant access (fail-open approach)\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"params"})," (object):","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"provider"})," ('iapkit'): The verification provider to use"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"iapkit?"})," (object): IAPKit-specific configuration","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"apiKey?"})," (string): Your IAPKit API key. ",(0,s.jsxs)(n.strong,{children:["Optional since v14.6.1 if configured via ",(0,s.jsx)(n.a,{href:"/docs/guides/expo-plugin#iapkit-api-key",children:"Expo config plugin"})]})," - will be automatically read from native config (Info.plist on iOS, AndroidManifest.xml on Android). If provided, takes priority over config plugin."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"apple?"})," (object): iOS verification data","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"jws"})," (string): The JWS token from the purchase"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"google?"})," (object): Android verification data","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"purchaseToken"})," (string): The purchase token"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<VerifyPurchaseWithProviderResult>"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"interface VerifyPurchaseWithProviderResult {\n  provider: 'iapkit';\n  iapkit?: {\n    isValid: boolean;\n    state: IapkitPurchaseState;\n    store: IapStore;\n  } | null;\n  errors?: VerifyPurchaseWithProviderError[] | null;\n}\n\ninterface VerifyPurchaseWithProviderError {\n  code?: string | null;\n  message: string;\n}\n\ntype IapkitPurchaseState =\n  | 'pending'\n  | 'unknown'\n  | 'entitled'\n  | 'pending-acknowledgment'\n  | 'canceled'\n  | 'expired'\n  | 'ready-to-consume'\n  | 'consumed'\n  | 'inauthentic';\n\ntype IapStore = 'unknown' | 'apple' | 'google' | 'horizon';\n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["For detailed descriptions of each ",(0,s.jsx)(n.code,{children:"IapkitPurchaseState"}),", see the ",(0,s.jsx)(n.a,{href:"https://www.openiap.dev/docs/apis#iapkit-purchase-states",children:"OpenIAP IAPKit Purchase States documentation"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Platform Behavior:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"iOS"}),": Sends the JWS (JSON Web Signature) token to IAPKit for server-side verification"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Android"}),": Sends the purchase token along with package name and product ID for verification"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Both"}),": Returns the verification state and validity from IAPKit's servers"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Server-side receipt validation without maintaining your own validation infrastructure"}),"\n",(0,s.jsx)(n.li,{children:"Cross-platform purchase verification with a unified API"}),"\n",(0,s.jsx)(n.li,{children:"Enhanced security through external verification services"}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," You need an IAPKit API key to use this feature. Visit ",(0,s.jsx)(a.A,{children:"iapkit.com"})," to get started."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"error-handling--purchase-identifiers",children:"Error Handling & Purchase Identifiers"}),"\n",(0,s.jsxs)(n.p,{children:["For detailed guidance on error handling best practices and purchase identifier usage, see the ",(0,s.jsx)(n.a,{href:"https://www.openiap.dev/docs/apis#verification-error-handling",children:"OpenIAP Verification Error Handling documentation"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"purchase-interface",children:"Purchase Interface"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"interface Purchase {\n  id: string; // Transaction identifier\n  productId: string;\n  transactionDate: number;\n  purchaseToken?: string; // Unified token (iOS JWS or Android token)\n\n  // iOS-specific properties\n  originalTransactionDateIOS?: number;\n  originalTransactionIdentifierIOS?: string;\n  expirationDateIOS?: number;\n  environmentIOS?: 'Production' | 'Sandbox';\n\n  // Android-specific properties\n  dataAndroid?: string;\n  signatureAndroid?: string;\n  purchaseStateAndroid?: number;\n  isAcknowledgedAndroid?: boolean;\n  packageNameAndroid?: string;\n  developerPayloadAndroid?: string;\n  obfuscatedAccountIdAndroid?: string;\n  obfuscatedProfileIdAndroid?: string;\n  autoRenewingAndroid?: boolean;\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"platform-specific-apis",children:"Platform-specific APIs"}),"\n",(0,s.jsx)(n.h3,{id:"ios-specific",children:"iOS Specific"}),"\n",(0,s.jsx)(n.p,{children:"The following iOS\u2011only helpers expose StoreKit and App Store specific capabilities. Most day\u2011to\u2011day flows are covered by the cross\u2011platform Core Methods above; use these only when you need iOS features."}),"\n",(0,s.jsx)(n.h3,{id:"cleartransactionios",children:"clearTransactionIOS()"}),"\n",(0,s.jsx)(n.p,{children:"Clears all pending transactions from the iOS payment queue. Useful if your app previously crashed or missed finishing transactions."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import {clearTransactionIOS, getPendingTransactionsIOS} from 'react-native-iap';\n\n// Inspect then clear\nconst pending = await getPendingTransactionsIOS();\nif (pending.length) {\n  await clearTransactionIOS();\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns: ",(0,s.jsx)(n.code,{children:"Promise<void>"})]}),"\n",(0,s.jsx)(n.h3,{id:"getstorefrontios",children:"getStorefrontIOS()"}),"\n",(0,s.jsx)(n.p,{children:'Returns the current App Store storefront country code (for example, "US", "GB").'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import {getStorefrontIOS} from 'react-native-iap';\n\nconst storefront = await getStorefrontIOS();\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns: ",(0,s.jsx)(n.code,{children:"Promise<string>"})]}),"\n",(0,s.jsx)(n.h3,{id:"getpromotedproductios",children:"getPromotedProductIOS()"}),"\n",(0,s.jsx)(n.p,{children:"Gets the currently promoted product, if any. Requires iOS 11+."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import {getPromotedProductIOS} from 'react-native-iap';\n\nconst promoted = await getPromotedProductIOS();\nif (promoted) {\n  // Show your purchase UI for the promoted product\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns: ",(0,s.jsx)(n.code,{children:"Promise<Product | null>"})]}),"\n",(0,s.jsx)(n.h3,{id:"requestpurchaseonpromotedproductios",children:"requestPurchaseOnPromotedProductIOS()"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Deprecated"}),": In StoreKit 2, promoted products can be purchased directly via the standard ",(0,s.jsx)(n.code,{children:"requestPurchase()"})," flow. Use ",(0,s.jsx)(n.code,{children:"promotedProductListenerIOS"})," to receive the product ID when a user taps a promoted product, then call ",(0,s.jsx)(n.code,{children:"requestPurchase()"})," with the received SKU directly."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Initiates the purchase flow for the currently promoted product. Requires iOS 11+."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// Recommended approach (StoreKit 2)\nimport {promotedProductListenerIOS, requestPurchase} from 'react-native-iap';\n\npromotedProductListenerIOS(async (product) => {\n  await requestPurchase({\n    request: { apple: { sku: product.id } },\n    type: 'in-app',\n  });\n});\n\n// Legacy approach (deprecated)\nimport {requestPurchaseOnPromotedProductIOS} from 'react-native-iap';\n\nconst success = await requestPurchaseOnPromotedProductIOS();\n// Purchase result is delivered via purchase listeners/useIAP callbacks\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns: ",(0,s.jsx)(n.code,{children:"Promise<boolean>"})," - ",(0,s.jsx)(n.code,{children:"true"})," when the request triggers successfully"]}),"\n",(0,s.jsx)(n.h3,{id:"getpendingtransactionsios",children:"getPendingTransactionsIOS()"}),"\n",(0,s.jsx)(n.p,{children:"Returns all transactions that are pending completion in the StoreKit payment queue."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import {getPendingTransactionsIOS} from 'react-native-iap';\n\nconst pending = await getPendingTransactionsIOS();\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns: ",(0,s.jsx)(n.code,{children:"Promise<Purchase[]>"})]}),"\n",(0,s.jsx)(n.h3,{id:"iseligibleforintroofferios",children:"isEligibleForIntroOfferIOS()"}),"\n",(0,s.jsx)(n.p,{children:"Checks if the user is eligible for an introductory offer for a subscription group. Requires iOS 12.2+."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import {isEligibleForIntroOfferIOS, fetchProducts} from 'react-native-iap';\n\n// Example: derive group ID from a fetched subscription product\nconst [sub] = await fetchProducts({skus: ['your_sub_sku'], type: 'subs'});\nconst groupId = sub?.subscriptionInfoIOS?.subscriptionGroupId ?? '';\nconst eligible = groupId ? await isEligibleForIntroOfferIOS(groupId) : false;\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns: ",(0,s.jsx)(n.code,{children:"Promise<boolean>"})]}),"\n",(0,s.jsx)(n.h3,{id:"subscriptionstatusios",children:"subscriptionStatusIOS()"}),"\n",(0,s.jsx)(n.p,{children:"Returns detailed subscription status information using StoreKit 2. Requires iOS 15+."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import {subscriptionStatusIOS} from 'react-native-iap';\n\nconst statuses = await subscriptionStatusIOS('your_sub_sku');\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns: ",(0,s.jsx)(n.code,{children:"Promise<SubscriptionStatusIOS[]>"})]}),"\n",(0,s.jsx)(n.h3,{id:"currententitlementios",children:"currentEntitlementIOS()"}),"\n",(0,s.jsx)(n.p,{children:"Returns the current entitlement for a given SKU using StoreKit 2. Requires iOS 15+."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import {currentEntitlementIOS} from 'react-native-iap';\n\nconst entitlement = await currentEntitlementIOS('your_sub_or_product_sku');\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns: ",(0,s.jsx)(n.code,{children:"Promise<Purchase | null>"})]}),"\n",(0,s.jsx)(n.h3,{id:"latesttransactionios",children:"latestTransactionIOS()"}),"\n",(0,s.jsx)(n.p,{children:"Returns the most recent transaction for a given SKU using StoreKit 2. Requires iOS 15+."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import {latestTransactionIOS} from 'react-native-iap';\n\nconst last = await latestTransactionIOS('your_sku');\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns: ",(0,s.jsx)(n.code,{children:"Promise<Purchase | null>"})]}),"\n",(0,s.jsx)(n.h3,{id:"showmanagesubscriptionsios",children:"showManageSubscriptionsIOS()"}),"\n",(0,s.jsx)(n.p,{children:"Opens the native subscription management interface and returns purchases for subscriptions whose auto\u2011renewal status changed while the sheet was open. Requires iOS 15+."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import {showManageSubscriptionsIOS} from 'react-native-iap';\n\nconst changed = await showManageSubscriptionsIOS();\nif (changed.length > 0) {\n  // Update your UI / server using returned purchases\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns: ",(0,s.jsx)(n.code,{children:"Promise<Purchase[]>"})]}),"\n",(0,s.jsx)(n.h3,{id:"beginrefundrequestios",children:"beginRefundRequestIOS()"}),"\n",(0,s.jsx)(n.p,{children:"Presents the refund request sheet for a specific SKU. Requires iOS 15+."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import {beginRefundRequestIOS} from 'react-native-iap';\n\nconst status = await beginRefundRequestIOS('your_sku');\n// status: 'success' | 'userCancelled'\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns: ",(0,s.jsx)(n.code,{children:"Promise<'success' | 'userCancelled'>"})]}),"\n",(0,s.jsx)(n.h3,{id:"istransactionverifiedios",children:"isTransactionVerifiedIOS()"}),"\n",(0,s.jsx)(n.p,{children:"Verifies the latest transaction for a given SKU using StoreKit 2. Requires iOS 15+."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import {isTransactionVerifiedIOS} from 'react-native-iap';\n\nconst ok = await isTransactionVerifiedIOS('your_sku');\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns: ",(0,s.jsx)(n.code,{children:"Promise<boolean>"})]}),"\n",(0,s.jsx)(n.h3,{id:"gettransactionjwsios",children:"getTransactionJwsIOS()"}),"\n",(0,s.jsx)(n.p,{children:"Returns the JSON Web Signature (JWS) for a transaction derived from a given SKU. Use this for server\u2011side validation. Requires iOS 15+."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import {getTransactionJwsIOS} from 'react-native-iap';\n\nconst jws = await getTransactionJwsIOS('your_sku');\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns: ",(0,s.jsx)(n.code,{children:"Promise<string>"})]}),"\n",(0,s.jsx)(n.h3,{id:"getreceiptdataios",children:"getReceiptDataIOS()"}),"\n",(0,s.jsx)(n.p,{children:"Returns the base64\u2011encoded receipt data for server validation."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import {getReceiptDataIOS} from 'react-native-iap';\n\nconst receipt = await getReceiptDataIOS();\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns: ",(0,s.jsx)(n.code,{children:"Promise<string>"})]}),"\n",(0,s.jsx)(n.h3,{id:"syncios",children:"syncIOS()"}),"\n",(0,s.jsx)(n.p,{children:"Forces a sync with StoreKit to ensure all transactions are up to date. Requires iOS 15+."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import {syncIOS} from 'react-native-iap';\n\nawait syncIOS();\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns: ",(0,s.jsx)(n.code,{children:"Promise<void>"})]}),"\n",(0,s.jsx)(n.h3,{id:"presentcoderedemptionsheetios",children:"presentCodeRedemptionSheetIOS()"}),"\n",(0,s.jsx)(n.p,{children:"Presents the system sheet for redeeming App Store promo/offer codes."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import {presentCodeRedemptionSheetIOS} from 'react-native-iap';\n\nawait presentCodeRedemptionSheetIOS();\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns: ",(0,s.jsx)(n.code,{children:"Promise<boolean>"})]}),"\n",(0,s.jsx)(n.h3,{id:"getapptransactionios",children:"getAppTransactionIOS()"}),"\n",(0,s.jsx)(n.p,{children:"Gets app transaction information for iOS apps (iOS 16.0+). AppTransaction represents the initial purchase that unlocked the app, useful for premium apps or apps that were previously paid."}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Runtime: iOS 16.0+; Build: Xcode 15.0+ with iOS 16.0 SDK. Older SDKs will throw."}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {getAppTransactionIOS} from 'react-native-iap';\n\nconst fetchAppTransaction = async () => {\n  try {\n    const appTransaction = await getAppTransactionIOS();\n    if (appTransaction) {\n      console.log('App Transaction ID:', appTransaction.appTransactionId);\n      console.log(\n        'Original Purchase Date:',\n        new Date(appTransaction.originalPurchaseDate),\n      );\n      console.log('Device Verification:', appTransaction.deviceVerification);\n    }\n  } catch (error) {\n    console.error('Failed to get app transaction:', error);\n  }\n};\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<AppTransaction | null>"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"interface AppTransaction {\n  appTransactionId?: string; // iOS 18.4+\n  originalPlatform?: string; // iOS 18.4+\n  bundleId: string;\n  appVersion: string;\n  originalAppVersion: string;\n  originalPurchaseDate: number; // ms since epoch\n  deviceVerification: string;\n  deviceVerificationNonce: string;\n  environment: string;\n  signedDate: number;\n  appId?: number;\n  appVersionId?: number;\n  preorderDate?: number;\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"android-specific",children:"Android Specific"}),"\n",(0,s.jsx)(n.h4,{id:"acknowledgepurchaseandroid",children:"acknowledgePurchaseAndroid"}),"\n",(0,s.jsx)(n.p,{children:"Acknowledge a non\u2011consumable purchase or subscription on Android."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import {acknowledgePurchaseAndroid} from 'react-native-iap';\n\nawait acknowledgePurchaseAndroid({token: purchase.purchaseToken!});\n"})}),"\n",(0,s.jsx)(n.p,{children:"Notes:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["finishTransaction() calls this automatically when ",(0,s.jsx)(n.code,{children:"isConsumable"})," is false. You typically do not need to call it directly."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"consumepurchaseandroid",children:"consumePurchaseAndroid"}),"\n",(0,s.jsx)(n.p,{children:"Consume a purchase (consumables only). This marks an item as consumed so it can be purchased again."}),"\n",(0,s.jsx)(n.p,{children:"Notes:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["finishTransaction() calls Android consumption automatically when ",(0,s.jsx)(n.code,{children:"isConsumable"})," is true."]}),"\n",(0,s.jsx)(n.li,{children:"A direct JS helper is not exposed; consumption is handled internally via the native module."}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"flushfailedpurchasescachedaspendingandroid-removed",children:"flushFailedPurchasesCachedAsPendingAndroid (Removed)"}),"\n",(0,s.jsx)(n.p,{children:"This legacy helper from older libraries has been removed. The modern flow is:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// On app startup (Android)\nconst purchases = await getAvailablePurchases();\n\nfor (const p of purchases) {\n  if (/* consumable */) {\n    // finishTransaction will consume on Android when isConsumable is true\n    await finishTransaction({ purchase: p, isConsumable: true });\n  } else {\n    // finishTransaction will acknowledge on Android when isConsumable is false\n    await finishTransaction({ purchase: p, isConsumable: false });\n  }\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"This ensures pending transactions are surfaced and properly resolved without a separate \u201cflush\u201d API."}),"\n",(0,s.jsx)(n.h2,{id:"alternative-billing-apis",children:"Alternative Billing APIs"}),"\n",(0,s.jsx)(n.p,{children:"Alternative billing enables developers to offer payment options outside of the platform's standard billing systems. Both platforms require special approval."}),"\n",(0,s.jsx)(n.h3,{id:"billing-programs-api-android-820---recommended",children:"Billing Programs API (Android 8.2.0+) - Recommended"}),"\n",(0,s.jsx)(n.admonition,{title:"New in 14.6.0",type:"tip",children:(0,s.jsx)(n.p,{children:"The Billing Programs API is the recommended approach for apps using Google Play Billing Library 8.2.0+. It replaces the deprecated alternative billing APIs."})}),"\n",(0,s.jsx)(n.h4,{id:"enablebillingprogramandroid",children:"enableBillingProgramAndroid()"}),"\n",(0,s.jsxs)(n.p,{children:["Enable a billing program before calling ",(0,s.jsx)(n.code,{children:"initConnection()"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {enableBillingProgramAndroid, initConnection} from 'react-native-iap';\n\n// Enable before initConnection\nenableBillingProgramAndroid('external-offer');\nawait initConnection();\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"program"}),": ",(0,s.jsx)(n.code,{children:"BillingProgramAndroid"})," - ",(0,s.jsx)(n.code,{children:"'unspecified'"})," | ",(0,s.jsx)(n.code,{children:"'external-content-link'"})," | ",(0,s.jsx)(n.code,{children:"'external-offer'"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"void"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Platform:"})," Android only"]}),"\n",(0,s.jsx)(n.h4,{id:"isbillingprogramavailableandroid",children:"isBillingProgramAvailableAndroid()"}),"\n",(0,s.jsx)(n.p,{children:"Check if a billing program is available for the current user."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {isBillingProgramAvailableAndroid} from 'react-native-iap';\n\nconst result = await isBillingProgramAvailableAndroid('external-offer');\nif (result.isAvailable) {\n  // Program is available for this user\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"program"}),": ",(0,s.jsx)(n.code,{children:"BillingProgramAndroid"})," - The billing program to check"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<BillingProgramAvailabilityResultAndroid>"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"interface BillingProgramAvailabilityResultAndroid {\n  billingProgram: BillingProgramAndroid;\n  isAvailable: boolean;\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Platform:"})," Android only"]}),"\n",(0,s.jsx)(n.h4,{id:"createbillingprogramreportingdetailsandroid",children:"createBillingProgramReportingDetailsAndroid()"}),"\n",(0,s.jsx)(n.p,{children:"Create reporting details with an external transaction token for Google Play reporting."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {createBillingProgramReportingDetailsAndroid} from 'react-native-iap';\n\nconst details = await createBillingProgramReportingDetailsAndroid('external-offer');\n// Send details.externalTransactionToken to your backend for Google Play reporting\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"program"}),": ",(0,s.jsx)(n.code,{children:"BillingProgramAndroid"})," - The billing program"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<BillingProgramReportingDetailsAndroid>"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"interface BillingProgramReportingDetailsAndroid {\n  billingProgram: BillingProgramAndroid;\n  externalTransactionToken: string;\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Platform:"})," Android only"]}),"\n",(0,s.jsx)(n.h4,{id:"launchexternallinkandroid",children:"launchExternalLinkAndroid()"}),"\n",(0,s.jsx)(n.p,{children:"Launch an external link for billing programs."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {launchExternalLinkAndroid} from 'react-native-iap';\n\nconst success = await launchExternalLinkAndroid({\n  billingProgram: 'external-offer',\n  launchMode: 'launch-in-external-browser-or-app',\n  linkType: 'link-to-digital-content-offer',\n  linkUri: 'https://your-website.com/purchase',\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"params"}),": ",(0,s.jsx)(n.code,{children:"LaunchExternalLinkParamsAndroid"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"billingProgram"}),": ",(0,s.jsx)(n.code,{children:"BillingProgramAndroid"})," - The billing program"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"launchMode"}),": ",(0,s.jsx)(n.code,{children:"ExternalLinkLaunchModeAndroid"})," - How to launch the link"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"linkType"}),": ",(0,s.jsx)(n.code,{children:"ExternalLinkTypeAndroid"})," - Type of external link"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"linkUri"}),": ",(0,s.jsx)(n.code,{children:"string"})," - The URL to open"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<boolean>"})," - ",(0,s.jsx)(n.code,{children:"true"})," if launch was successful"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Platform:"})," Android only"]}),"\n",(0,s.jsx)(n.h4,{id:"complete-billing-programs-flow",children:"Complete Billing Programs Flow"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {\n  enableBillingProgramAndroid,\n  isBillingProgramAvailableAndroid,\n  createBillingProgramReportingDetailsAndroid,\n  launchExternalLinkAndroid,\n  initConnection,\n} from 'react-native-iap';\n\n// Step 1: Enable billing program BEFORE initConnection\nenableBillingProgramAndroid('external-offer');\n\n// Step 2: Initialize connection\nawait initConnection();\n\n// Step 3: Check if program is available\nconst {isAvailable} = await isBillingProgramAvailableAndroid('external-offer');\nif (!isAvailable) {\n  console.log('External offers not available for this user');\n  return;\n}\n\n// Step 4: Launch external link\nconst success = await launchExternalLinkAndroid({\n  billingProgram: 'external-offer',\n  launchMode: 'launch-in-external-browser-or-app',\n  linkType: 'link-to-digital-content-offer',\n  linkUri: 'https://your-website.com/purchase',\n});\n\nif (success) {\n  // Step 5: Get reporting token after external purchase\n  const details = await createBillingProgramReportingDetailsAndroid('external-offer');\n\n  // Step 6: Report to Google Play backend\n  await reportExternalTransaction(details.externalTransactionToken);\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"legacy-alternative-billing-apis-pre-820",children:"Legacy Alternative Billing APIs (Pre-8.2.0)"}),"\n",(0,s.jsx)(n.p,{children:"For apps using older Billing Library versions, the legacy APIs are still supported but deprecated."}),"\n",(0,s.jsx)(n.h3,{id:"android-alternative-billing-legacy",children:"Android Alternative Billing (Legacy)"}),"\n",(0,s.jsx)(n.p,{children:"Android supports two modes:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Alternative Billing Only"}),": Only your payment system is available"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"User Choice Billing"}),": Users choose between Google Play and your payment system"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"initialize-with-alternative-billing",children:"Initialize with Alternative Billing"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {initConnection} from 'react-native-iap';\n\n// Alternative Billing Only mode\nawait initConnection({\n  alternativeBillingModeAndroid: 'alternative-only',\n});\n\n// User Choice Billing mode\nawait initConnection({\n  alternativeBillingModeAndroid: 'user-choice',\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"alternativeBillingModeAndroid"}),": ",(0,s.jsx)(n.code,{children:"'none'"})," | ",(0,s.jsx)(n.code,{children:"'alternative-only'"})," | ",(0,s.jsx)(n.code,{children:"'user-choice'"})]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"checkalternativebillingavailabilityandroid",children:"checkAlternativeBillingAvailabilityAndroid()"}),"\n",(0,s.jsx)(n.p,{children:"Check if alternative billing is available for the current user/device."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {checkAlternativeBillingAvailabilityAndroid} from 'react-native-iap';\n\nconst isAvailable = await checkAlternativeBillingAvailabilityAndroid();\nif (isAvailable) {\n  // Proceed with alternative billing flow\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<boolean>"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Platform:"})," Android only"]}),"\n",(0,s.jsx)(n.h4,{id:"showalternativebillingdialogandroid",children:"showAlternativeBillingDialogAndroid()"}),"\n",(0,s.jsxs)(n.p,{children:["Show the alternative billing information dialog to the user. Must be called ",(0,s.jsx)(n.strong,{children:"before"})," processing payment in your payment system."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {showAlternativeBillingDialogAndroid} from 'react-native-iap';\n\nconst userAccepted = await showAlternativeBillingDialogAndroid();\nif (userAccepted) {\n  // User accepted - process payment in your system\n  const success = await processCustomPayment();\n\n  if (success) {\n    // Create token for Google Play reporting\n    const token = await createAlternativeBillingTokenAndroid();\n  }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<boolean>"})," - ",(0,s.jsx)(n.code,{children:"true"})," if user accepted, ",(0,s.jsx)(n.code,{children:"false"})," if cancelled"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Platform:"})," Android only"]}),"\n",(0,s.jsx)(n.h4,{id:"createalternativebillingtokenandroid",children:"createAlternativeBillingTokenAndroid()"}),"\n",(0,s.jsxs)(n.p,{children:["Create an external transaction token for Google Play reporting. Must be called ",(0,s.jsx)(n.strong,{children:"after"})," successful payment in your payment system. Token must be reported to Google Play backend within 24 hours."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {createAlternativeBillingTokenAndroid} from 'react-native-iap';\n\n// After successful payment in your system\nconst token = await createAlternativeBillingTokenAndroid(\n  'premium_subscription',\n);\n\nif (token) {\n  // Send token to your backend for Google Play reporting\n  await fetch('/api/report-transaction', {\n    method: 'POST',\n    body: JSON.stringify({token, productId: 'premium_subscription'}),\n  });\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"sku?: string"})," - Optional product SKU that was purchased"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<string | null>"})," - Token string or null if creation failed"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Platform:"})," Android only"]}),"\n",(0,s.jsx)(n.h4,{id:"complete-alternative-billing-flow-android",children:"Complete Alternative Billing Flow (Android)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"// Step 1: Check availability\nconst isAvailable = await checkAlternativeBillingAvailabilityAndroid();\nif (!isAvailable) {\n  console.log('Alternative billing not available');\n  return;\n}\n\n// Step 2: Show information dialog\nconst userAccepted = await showAlternativeBillingDialogAndroid();\nif (!userAccepted) {\n  console.log('User cancelled');\n  return;\n}\n\n// Step 3: Process payment in your payment system\nconst paymentSuccess = await yourPaymentSystem.processPayment({\n  productId: 'premium_subscription',\n  amount: 9.99,\n});\n\nif (!paymentSuccess) {\n  console.log('Payment failed');\n  return;\n}\n\n// Step 4: Create token for Google Play reporting\nconst token = await createAlternativeBillingTokenAndroid(\n  'premium_subscription',\n);\n\nif (token) {\n  // Step 5: Report to Google Play backend (within 24 hours)\n  await yourBackend.reportToGooglePlay({\n    token,\n    productId: 'premium_subscription',\n    userId: currentUser.id,\n  });\n\n  console.log('Alternative billing completed successfully');\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"ios-external-purchase",children:"iOS External Purchase"}),"\n",(0,s.jsx)(n.p,{children:"iOS alternative billing works by redirecting users to an external website where they complete the purchase."}),"\n",(0,s.jsx)(n.h4,{id:"canpresentexternalpurchasenoticeios",children:"canPresentExternalPurchaseNoticeIOS()"}),"\n",(0,s.jsx)(n.p,{children:"Check if the device can present an external purchase notice sheet."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {canPresentExternalPurchaseNoticeIOS} from 'react-native-iap';\n\nconst canPresent = await canPresentExternalPurchaseNoticeIOS();\nif (canPresent) {\n  // Present notice before external purchase\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<boolean>"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Platform:"})," iOS 18.2+ only"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Requires:"})," ",(0,s.jsx)(n.code,{children:"com.apple.developer.storekit.external-purchase"})," entitlement"]}),"\n",(0,s.jsx)(n.h4,{id:"presentexternalpurchasenoticesheetios",children:"presentExternalPurchaseNoticeSheetIOS()"}),"\n",(0,s.jsx)(n.p,{children:"Present an external purchase notice sheet to inform users about external purchases. This must be called before opening an external purchase link."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {presentExternalPurchaseNoticeSheetIOS} from 'react-native-iap';\n\nconst result = await presentExternalPurchaseNoticeSheetIOS();\n\nif (result.result === 'continue') {\n  // User chose to continue, open external purchase link\n  await presentExternalPurchaseLinkIOS('https://your-website.com/purchase');\n} else if (result.result === 'cancel') {\n  console.log('User cancelled');\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<ExternalPurchaseNoticeResultIOS>"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"interface ExternalPurchaseNoticeResultIOS {\n  result: 'continue' | 'cancel';\n  error?: string;\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Platform:"})," iOS 18.2+ only"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Requires:"})," ",(0,s.jsx)(n.code,{children:"com.apple.developer.storekit.external-purchase"})," entitlement"]}),"\n",(0,s.jsx)(n.h4,{id:"presentexternalpurchaselinkios",children:"presentExternalPurchaseLinkIOS()"}),"\n",(0,s.jsx)(n.p,{children:"Present an external purchase link to redirect users to your website."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {presentExternalPurchaseLinkIOS} from 'react-native-iap';\n\nconst result = await presentExternalPurchaseLinkIOS(\n  'https://your-website.com/purchase',\n);\n\nif (result.success) {\n  console.log('User was redirected to external website');\n  // Complete purchase on your website\n  // Implement deep link to return to app\n} else if (result.error) {\n  console.error('Error:', result.error);\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"url: string"})," - The external purchase URL to open"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Returns:"})," ",(0,s.jsx)(n.code,{children:"Promise<ExternalPurchaseLinkResultIOS>"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"interface ExternalPurchaseLinkResultIOS {\n  success: boolean;\n  error?: string;\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Platform:"})," iOS 16.0+ only"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Requires:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"com.apple.developer.storekit.external-purchase"})," entitlement"]}),"\n",(0,s.jsx)(n.li,{children:"URL must be configured in Info.plist"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"ios-configuration",children:"iOS Configuration"}),"\n",(0,s.jsx)(n.p,{children:"For iOS alternative billing, you need to configure your app with the Expo config plugin:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"// app.config.ts\nexport default {\n  plugins: [\n    [\n      'react-native-iap',\n      {\n        iosAlternativeBilling: {\n          // Required: Countries where external purchases are supported\n          countries: ['kr', 'nl', 'de', 'fr'], // ISO 3166-1 alpha-2\n\n          // Optional: External purchase URLs per country (iOS 15.4+)\n          links: {\n            kr: 'https://your-site.com/kr/checkout',\n            nl: 'https://your-site.com/nl/checkout',\n          },\n\n          // Optional: Multiple URLs per country (iOS 17.5+, up to 5)\n          multiLinks: {\n            de: [\n              'https://your-site.com/de/checkout',\n              'https://your-site.com/de/special-offer',\n            ],\n          },\n\n          // Optional: Custom link regions (iOS 18.1+)\n          customLinkRegions: ['de', 'fr', 'nl'],\n\n          // Optional: Streaming regions for music apps (iOS 18.2+)\n          streamingLinkRegions: ['at', 'de', 'fr', 'nl'],\n\n          // Enable external purchase link entitlement\n          enableExternalPurchaseLink: true,\n\n          // Enable streaming entitlement (music apps only)\n          enableExternalPurchaseLinkStreaming: false,\n        },\n      },\n    ],\n  ],\n};\n"})}),"\n",(0,s.jsx)(n.p,{children:"This automatically adds the required entitlements and Info.plist configuration."}),"\n",(0,s.jsxs)(n.admonition,{title:"Requirements",type:"warning",children:[(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Approval Required"}),": You must obtain approval from Apple/Google to use alternative billing"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"iOS URL Format"}),": URLs must use HTTPS, have no query parameters, and be 1,000 characters or fewer"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Android Reporting"}),": External transaction tokens must be reported to Google Play within 24 hours"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Service Fees"}),": Reduced fees apply when using alternative billing (varies by platform and region) :::"]}),"\n"]}),(0,s.jsx)(n.p,{children:"For complete guides, see:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/guides/alternative-billing",children:"Alternative Billing Guide"})," (coming soon)"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.openiap.dev/docs/alternative-billing",children:"OpenIAP Alternative Billing"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://developer.apple.com/documentation/storekit/external-purchase",children:"Apple External Purchase"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://developer.android.com/google/play/billing/alternative",children:"Google Alternative Billing"})}),"\n"]}),(0,s.jsx)(n.h2,{id:"removed-apis",children:"Removed APIs"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"requestProducts()"})," \u2014 Removed in v3.0.0. Use ",(0,s.jsx)(n.code,{children:"fetchProducts({ skus, type })"})," instead."]}),"\n"]})]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},71437:(e,n,i)=>{i.d(n,{A:()=>o});var r=i(96540),s=i(27856),t=i(74848);function o({children:e,className:n,style:i}){const o=(0,r.useCallback)(()=>{fetch(s.I,{method:"POST",mode:"no-cors"}).catch(()=>{})},[]);return(0,t.jsx)("a",{href:s.V,target:"_blank",rel:"noopener noreferrer",onClick:o,className:n,style:i,children:e})}}}]);