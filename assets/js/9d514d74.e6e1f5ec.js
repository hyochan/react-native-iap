"use strict";(self.webpackChunkreact_native_iap_docs=self.webpackChunkreact_native_iap_docs||[]).push([[3819],{8949:e=>{e.exports=JSON.parse('{"permalink":"/react-native-iap/blog/14.7.7","editUrl":"https://github.com/hyochan/react-native-iap/tree/main/docs/blog/2026-01-26-14.7.7-external-purchase-custom-link.md","source":"@site/blog/2026-01-26-14.7.7-external-purchase-custom-link.md","title":"14.7.7 - ExternalPurchaseCustomLink API (iOS 18.1+)","description":"react-native-iap 14.7.7 adds support for Apple\'s ExternalPurchaseCustomLink API (iOS 18.1+) for apps using custom external purchase links.","date":"2026-01-26T00:00:00.000Z","tags":[{"inline":false,"label":"Release","permalink":"/react-native-iap/blog/tags/release","description":"New version releases and updates"},{"inline":false,"label":"iOS","permalink":"/react-native-iap/blog/tags/ios","description":"iOS platform specific features"},{"inline":false,"label":"StoreKit","permalink":"/react-native-iap/blog/tags/storekit","description":"Apple StoreKit framework features"},{"inline":true,"label":"external-purchase","permalink":"/react-native-iap/blog/tags/external-purchase"},{"inline":true,"label":"ios-18","permalink":"/react-native-iap/blog/tags/ios-18"}],"readingTime":2.54,"hasTruncateMarker":true,"authors":[{"name":"Hyo","title":"React Native IAP Maintainer","url":"https://github.com/hyochan","page":{"permalink":"/react-native-iap/blog/authors/hyochan"},"socials":{"github":"https://github.com/hyochan","linkedin":"https://www.linkedin.com/in/hyochanjang/","x":"https://x.com/hyodotdev"},"imageURL":"https://github.com/hyochan.png","key":"hyochan"}],"frontMatter":{"slug":"14.7.7","title":"14.7.7 - ExternalPurchaseCustomLink API (iOS 18.1+)","authors":["hyochan"],"tags":["release","ios","storekit","external-purchase","ios-18"],"date":"2026-01-26T00:00:00.000Z"},"unlisted":false,"prevItem":{"title":"14.7.9 - tvOS, macOS & watchOS Support","permalink":"/react-native-iap/blog/14.7.9"},"nextItem":{"title":"14.7.4 - Android Input Type Field Naming Simplification","permalink":"/react-native-iap/blog/14.7.4-android-input-naming"}}')},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var s=t(96540);const r={},i=s.createContext(r);function a(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:n},e.children)}},95028:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>c});var s=t(8949),r=t(74848),i=t(28453);const a={slug:"14.7.7",title:"14.7.7 - ExternalPurchaseCustomLink API (iOS 18.1+)",authors:["hyochan"],tags:["release","ios","storekit","external-purchase","ios-18"],date:new Date("2026-01-26T00:00:00.000Z")},o="14.7.7 Release Notes",l={authorsImageUrls:[void 0]},c=[{value:"New Features",id:"new-features",level:2},{value:"ExternalPurchaseCustomLink API (iOS 18.1+)",id:"externalpurchasecustomlink-api-ios-181",level:3},{value:"New APIs",id:"new-apis",level:3},{value:"<code>isEligibleForExternalPurchaseCustomLinkIOS()</code>",id:"iseligibleforexternalpurchasecustomlinkios",level:4},{value:"<code>getExternalPurchaseCustomLinkTokenIOS(tokenType)</code>",id:"getexternalpurchasecustomlinktokeniostokentype",level:4},{value:"<code>showExternalPurchaseCustomLinkNoticeIOS(noticeType)</code>",id:"showexternalpurchasecustomlinknoticeiosnoticetype",level:4},{value:"Updated: <code>presentExternalPurchaseNoticeSheetIOS()</code>",id:"updated-presentexternalpurchasenoticesheetios",level:3},{value:"New Types",id:"new-types",level:3},{value:"Complete External Purchase Custom Link Flow",id:"complete-external-purchase-custom-link-flow",level:3},{value:"OpenIAP Updates",id:"openiap-updates",level:2},{value:"Installation",id:"installation",level:2},{value:"References",id:"references",level:2}];function u(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["react-native-iap 14.7.7 adds support for Apple's ",(0,r.jsx)(n.strong,{children:"ExternalPurchaseCustomLink"})," API (iOS 18.1+) for apps using custom external purchase links."]}),"\n",(0,r.jsx)(n.h2,{id:"new-features",children:"New Features"}),"\n",(0,r.jsx)(n.h3,{id:"externalpurchasecustomlink-api-ios-181",children:"ExternalPurchaseCustomLink API (iOS 18.1+)"}),"\n",(0,r.jsx)(n.p,{children:"The ExternalPurchaseCustomLink API enables apps to use custom external purchase links with token-based reporting to Apple. This is for apps that have been granted an entitlement to link out to external purchases."}),"\n",(0,r.jsxs)(n.p,{children:["Reference: ",(0,r.jsx)(n.a,{href:"https://developer.apple.com/documentation/storekit/externalpurchasecustomlink",children:"ExternalPurchaseCustomLink Documentation"})]}),"\n",(0,r.jsx)(n.h3,{id:"new-apis",children:"New APIs"}),"\n",(0,r.jsx)(n.h4,{id:"iseligibleforexternalpurchasecustomlinkios",children:(0,r.jsx)(n.code,{children:"isEligibleForExternalPurchaseCustomLinkIOS()"})}),"\n",(0,r.jsx)(n.p,{children:"Check if your app is eligible to use the ExternalPurchaseCustomLink API."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import {isEligibleForExternalPurchaseCustomLinkIOS} from 'react-native-iap';\n\nconst isEligible = await isEligibleForExternalPurchaseCustomLinkIOS();\nif (isEligible) {\n  // App can use custom external purchase links\n}\n"})}),"\n",(0,r.jsx)(n.h4,{id:"getexternalpurchasecustomlinktokeniostokentype",children:(0,r.jsx)(n.code,{children:"getExternalPurchaseCustomLinkTokenIOS(tokenType)"})}),"\n",(0,r.jsx)(n.p,{children:"Get an external purchase token for reporting to Apple's External Purchase Server API."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import {getExternalPurchaseCustomLinkTokenIOS} from 'react-native-iap';\n\n// For new customer acquisition\nconst acquisitionResult = await getExternalPurchaseCustomLinkTokenIOS('acquisition');\nif (acquisitionResult.token) {\n  // Report to Apple's External Purchase Server API\n  await reportToApple(acquisitionResult.token);\n}\n\n// For existing customer services\nconst servicesResult = await getExternalPurchaseCustomLinkTokenIOS('services');\nif (servicesResult.token) {\n  await reportToApple(servicesResult.token);\n}\n"})}),"\n",(0,r.jsx)(n.h4,{id:"showexternalpurchasecustomlinknoticeiosnoticetype",children:(0,r.jsx)(n.code,{children:"showExternalPurchaseCustomLinkNoticeIOS(noticeType)"})}),"\n",(0,r.jsx)(n.p,{children:"Display the system disclosure notice sheet before linking out to external purchases."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import {showExternalPurchaseCustomLinkNoticeIOS} from 'react-native-iap';\n\nconst result = await showExternalPurchaseCustomLinkNoticeIOS('browser');\nif (result.continued) {\n  // User agreed to continue to external purchase\n  // Now open your external purchase link\n  await Linking.openURL('https://your-store.com/checkout');\n} else {\n  // User cancelled\n}\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"updated-presentexternalpurchasenoticesheetios",children:["Updated: ",(0,r.jsx)(n.code,{children:"presentExternalPurchaseNoticeSheetIOS()"})]}),"\n",(0,r.jsxs)(n.p,{children:["Now returns ",(0,r.jsx)(n.code,{children:"externalPurchaseToken"})," when user continues to external purchase."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import {presentExternalPurchaseNoticeSheetIOS} from 'react-native-iap';\n\nconst result = await presentExternalPurchaseNoticeSheetIOS();\nif (result.result === 'continue') {\n  console.log('Token:', result.externalPurchaseToken);\n  // Report this token to Apple's External Purchase Server API\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"new-types",children:"New Types"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// Token types for getExternalPurchaseCustomLinkTokenIOS\ntype ExternalPurchaseCustomLinkTokenTypeIOS = 'acquisition' | 'services';\n\n// Notice types for showExternalPurchaseCustomLinkNoticeIOS\ntype ExternalPurchaseCustomLinkNoticeTypeIOS = 'browser';\n\n// Result of token retrieval\ninterface ExternalPurchaseCustomLinkTokenResultIOS {\n  token?: string | null;\n  error?: string | null;\n}\n\n// Result of showing notice\ninterface ExternalPurchaseCustomLinkNoticeResultIOS {\n  continued: boolean;\n  error?: string | null;\n}\n\n// Updated ExternalPurchaseNoticeResultIOS\ninterface ExternalPurchaseNoticeResultIOS {\n  result: 'continue' | 'dismissed';\n  externalPurchaseToken?: string | null; // New field\n  error?: string | null;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"complete-external-purchase-custom-link-flow",children:"Complete External Purchase Custom Link Flow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import {useEffect, useState} from 'react';\nimport {Linking, Platform} from 'react-native';\nimport {\n  isEligibleForExternalPurchaseCustomLinkIOS,\n  getExternalPurchaseCustomLinkTokenIOS,\n  showExternalPurchaseCustomLinkNoticeIOS,\n} from 'react-native-iap';\n\nexport function ExternalPurchaseCustomLink() {\n  const [isEligible, setIsEligible] = useState(false);\n\n  useEffect(() => {\n    if (Platform.OS !== 'ios') return;\n\n    isEligibleForExternalPurchaseCustomLinkIOS().then(setIsEligible);\n  }, []);\n\n  const handleExternalPurchase = async () => {\n    // Step 1: Show disclosure notice\n    const noticeResult = await showExternalPurchaseCustomLinkNoticeIOS('browser');\n    if (!noticeResult.continued) {\n      console.log('User cancelled');\n      return;\n    }\n\n    // Step 2: Get token for reporting\n    const tokenResult = await getExternalPurchaseCustomLinkTokenIOS('acquisition');\n    if (tokenResult.error) {\n      console.error('Failed to get token:', tokenResult.error);\n      return;\n    }\n\n    // Step 3: Open external purchase link\n    await Linking.openURL('https://your-store.com/checkout');\n\n    // Step 4: After purchase completes, report to Apple\n    if (tokenResult.token) {\n      // This is a placeholder for your own server-side logic to report the token\n      // to Apple's External Purchase Server API.\n      // await reportExternalPurchaseToApple(tokenResult.token);\n    }\n  };\n\n  if (!isEligible) return null;\n\n  return (\n    <Button title=\"Purchase on Web\" onPress={handleExternalPurchase} />\n  );\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"openiap-updates",children:"OpenIAP Updates"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Package"}),(0,r.jsx)(n.th,{children:"Version"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"openiap-gql"}),(0,r.jsx)(n.td,{children:"1.3.16"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"openiap-apple"}),(0,r.jsx)(n.td,{children:"1.3.14"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"openiap-google"}),(0,r.jsx)(n.td,{children:"1.3.27"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm install react-native-iap@14.7.7\n# or\nyarn add react-native-iap@14.7.7\n"})}),"\n",(0,r.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://developer.apple.com/documentation/storekit/externalpurchasecustomlink",children:"Apple ExternalPurchaseCustomLink Documentation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.openiap.dev/docs/updates/notes#gql-1-3-16-apple-1-3-14",children:"OpenIAP Release Notes"})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Questions or feedback? Reach out via ",(0,r.jsx)(n.a,{href:"https://github.com/hyochan/react-native-iap/issues",children:"GitHub issues"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}}}]);