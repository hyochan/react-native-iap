"use strict";(self.webpackChunkreact_native_iap_docs=self.webpackChunkreact_native_iap_docs||[]).push([[2812],{6290:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>t,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"guides/error-handling","title":"Error Handling","description":"This guide covers best practices for handling errors in your react-native-iap implementation.","source":"@site/versioned_docs/version-14.4/guides/error-handling.md","sourceDirName":"guides","slug":"/guides/error-handling","permalink":"/react-native-iap/docs/14.4/guides/error-handling","draft":false,"unlisted":false,"editUrl":"https://github.com/hyochan/react-native-iap/tree/main/docs/versioned_docs/version-14.4/guides/error-handling.md","tags":[],"version":"14.4","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Alternative Billing","permalink":"/react-native-iap/docs/14.4/guides/alternative-billing"},"next":{"title":"Expo Plugin","permalink":"/react-native-iap/docs/14.4/guides/expo-plugin"}}');var s=n(74848),a=n(28453),i=n(35159);const t={sidebar_position:4},c="Error Handling",l={},d=[{value:"Overview",id:"overview",level:2},{value:"Error Structure",id:"error-structure",level:2},{value:"Common Error Scenarios",id:"common-error-scenarios",level:2},{value:"Network Errors",id:"network-errors",level:3},{value:"User Cancellation",id:"user-cancellation",level:3},{value:"Payment Issues",id:"payment-issues",level:3},{value:"Error Recovery Strategies",id:"error-recovery-strategies",level:2},{value:"Retry Logic",id:"retry-logic",level:3},{value:"Graceful Degradation",id:"graceful-degradation",level:3},{value:"Logging and Analytics",id:"logging-and-analytics",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Always Handle Errors",id:"1-always-handle-errors",level:3},{value:"2. Provide User-Friendly Messages",id:"2-provide-user-friendly-messages",level:3},{value:"3. Handle Platform Differences",id:"3-handle-platform-differences",level:3},{value:"See Also",id:"see-also",level:2}];function h(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"error-handling",children:"Error Handling"})}),"\n",(0,s.jsx)(i.A,{}),"\n",(0,s.jsx)(r.p,{children:"This guide covers best practices for handling errors in your react-native-iap implementation."}),"\n",(0,s.jsx)(r.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(r.p,{children:"React Native IAP provides comprehensive error handling through standardized error codes and messages. All errors are returned as structured objects with consistent properties across iOS and Android platforms."}),"\n",(0,s.jsxs)(r.p,{children:["For a complete list of error codes, see ",(0,s.jsx)(r.a,{href:"../api/error-codes",children:"Error Codes"}),"."]}),"\n",(0,s.jsx)(r.h2,{id:"error-structure",children:"Error Structure"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-typescript",children:"interface IapError {\n  code: string;\n  message: string;\n  debugMessage?: string;\n  underlyingError?: any;\n}\n"})}),"\n",(0,s.jsx)(r.h2,{id:"common-error-scenarios",children:"Common Error Scenarios"}),"\n",(0,s.jsx)(r.h3,{id:"network-errors",children:"Network Errors"}),"\n",(0,s.jsx)(r.p,{children:"Handle network connectivity issues gracefully:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-typescript",children:"import {useIAP, ErrorCode} from 'react-native-iap';\n\nconst {requestPurchase} = useIAP({\n  onPurchaseError: (error) => {\n    if (error.code === ErrorCode.NetworkError) {\n      // Handle network issues\n      showRetryDialog();\n    }\n  },\n});\n"})}),"\n",(0,s.jsx)(r.h3,{id:"user-cancellation",children:"User Cancellation"}),"\n",(0,s.jsx)(r.p,{children:"Gracefully handle when users cancel purchases:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-typescript",children:"import {useIAP, ErrorCode} from 'react-native-iap';\n\nconst {requestPurchase} = useIAP({\n  onPurchaseError: (error) => {\n    if (error.code === ErrorCode.UserCancelled) {\n      // User cancelled the purchase\n      // Don't show error message, just continue\n      return;\n    }\n  },\n});\n"})}),"\n",(0,s.jsx)(r.h3,{id:"payment-issues",children:"Payment Issues"}),"\n",(0,s.jsx)(r.p,{children:"Handle various payment-related errors:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-typescript",children:"import {useIAP, ErrorCode} from 'react-native-iap';\n\nconst {requestPurchase} = useIAP({\n  onPurchaseError: (error) => {\n    switch (error.code) {\n      case ErrorCode.DeveloperError:\n        showMessage(\n          'Invalid payment method. Please check your payment settings.',\n        );\n        break;\n      case ErrorCode.Unknown:\n        showMessage('Purchase failed. Please try again.');\n        break;\n      default:\n        showMessage('Purchase failed. Please try again.');\n    }\n  },\n});\n"})}),"\n",(0,s.jsx)(r.h2,{id:"error-recovery-strategies",children:"Error Recovery Strategies"}),"\n",(0,s.jsx)(r.h3,{id:"retry-logic",children:"Retry Logic"}),"\n",(0,s.jsx)(r.p,{children:"Implement exponential backoff for transient errors:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-typescript",children:"const retryWithBackoff = async (fn: () => Promise<any>, maxRetries = 3) => {\n  for (let i = 0; i < maxRetries; i++) {\n    try {\n      return await fn();\n    } catch (error) {\n      if (i === maxRetries - 1) throw error;\n\n      // Only retry on network or temporary errors\n      if (\n        [ErrorCode.NetworkError, ErrorCode.ServiceError].includes(error.code)\n      ) {\n        await new Promise((resolve) =>\n          setTimeout(resolve, Math.pow(2, i) * 1000),\n        );\n      } else {\n        throw error;\n      }\n    }\n  }\n};\n"})}),"\n",(0,s.jsx)(r.h3,{id:"graceful-degradation",children:"Graceful Degradation"}),"\n",(0,s.jsx)(r.p,{children:"Provide fallback experiences:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-typescript",children:"import {ErrorCode} from 'react-native-iap';\n\nconst handlePurchase = async (productId: string) => {\n  try {\n    await purchaseProduct(productId);\n  } catch (error) {\n    if (error.code === ErrorCode.IapNotAvailable) {\n      // Redirect to web subscription\n      redirectToWebPurchase(productId);\n    } else {\n      showErrorMessage(error.message);\n    }\n  }\n};\n"})}),"\n",(0,s.jsx)(r.h2,{id:"logging-and-analytics",children:"Logging and Analytics"}),"\n",(0,s.jsx)(r.p,{children:"Track errors for debugging and analytics:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-typescript",children:"const trackError = (error: IapError, context: string) => {\n  console.error(`IAP Error in ${context}:`, error);\n\n  // Send to analytics\n  analytics.track('iap_error', {\n    error_code: error.code,\n    error_message: error.message,\n    context,\n    platform: Platform.OS,\n  });\n};\n"})}),"\n",(0,s.jsx)(r.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsx)(r.h3,{id:"1-always-handle-errors",children:"1. Always Handle Errors"}),"\n",(0,s.jsx)(r.p,{children:"Never leave IAP operations without error handling:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-typescript",children:"// \u274c Bad\npurchaseProduct('product_id');\n\n// \u2705 Good\ntry {\n  await purchaseProduct('product_id');\n} catch (error) {\n  handlePurchaseError(error);\n}\n"})}),"\n",(0,s.jsx)(r.h3,{id:"2-provide-user-friendly-messages",children:"2. Provide User-Friendly Messages"}),"\n",(0,s.jsx)(r.p,{children:"Convert technical errors to user-friendly messages:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-typescript",children:"import {ErrorCode} from 'react-native-iap';\n\nconst getUserFriendlyMessage = (error: IapError): string | null => {\n  switch (error.code) {\n    case ErrorCode.UserCancelled:\n      return null; // Don't show message\n    case ErrorCode.NetworkError:\n      return 'Please check your internet connection and try again.';\n    case ErrorCode.Unknown:\n      return 'There was an issue with your payment method.';\n    default:\n      return 'Something went wrong. Please try again later.';\n  }\n};\n"})}),"\n",(0,s.jsx)(r.h3,{id:"3-handle-platform-differences",children:"3. Handle Platform Differences"}),"\n",(0,s.jsx)(r.p,{children:"Some errors may be platform-specific:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-typescript",children:"import {ErrorCode} from 'react-native-iap';\n\nconst handlePlatformSpecificError = (error: IapError) => {\n  if (Platform.OS === 'ios' && error.code === ErrorCode.ItemUnavailable) {\n    showMessage('This product is not available in your country.');\n  } else if (\n    Platform.OS === 'android' &&\n    error.code === ErrorCode.DeveloperError\n  ) {\n    // Log for debugging but don't show to user\n    console.error('Google Play configuration error:', error);\n  }\n};\n"})}),"\n",(0,s.jsx)(r.h2,{id:"see-also",children:"See Also"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.a,{href:"../api/error-codes",children:"Error Codes Reference"})," - Complete list of error codes"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.a,{href:"../api/use-iap",children:"Use IAP Hook"})," - Main API documentation"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.a,{href:"./troubleshooting",children:"Troubleshooting"})," - Common issues and solutions"]}),"\n"]})]})}function u(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},27856:(e,r,n)=>{n.d(r,{I:()=>s,V:()=>o});const o="https://iapkit.com",s="https://www.hyo.dev/api/ad-banner/cmjf0l2460003249hfyh029dm"},28453:(e,r,n)=>{n.d(r,{R:()=>i,x:()=>t});var o=n(96540);const s={},a=o.createContext(s);function i(e){const r=o.useContext(a);return o.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function t(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(a.Provider,{value:r},e.children)}},35159:(e,r,n)=>{n.d(r,{A:()=>t});var o=n(96540),s=n(86025),a=n(27856),i=n(74848);function t({className:e="iapkit-banner",style:r}){const n=(0,s.Ay)("/img/iapkit-banner.gif"),t=(0,o.useCallback)(e=>{fetch(a.I,{method:"POST",mode:"no-cors"}).catch(()=>{})},[]);return(0,i.jsx)("div",{className:e,style:{marginTop:0,marginBottom:12,textAlign:"center",...r},children:(0,i.jsx)("a",{href:a.V,target:"_blank",rel:"noopener noreferrer",onClick:t,style:{display:"inline-block",textDecoration:"none"},children:(0,i.jsx)("img",{src:n,alt:"IapKit - In-App Purchase Validation Service",style:{border:"none",display:"block"}})})})}}}]);