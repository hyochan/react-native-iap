"use strict";(self.webpackChunkreact_native_iap_docs=self.webpackChunkreact_native_iap_docs||[]).push([[4454],{17294:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>p,frontMatter:()=>c,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"getting-started/setup-android","title":"Android Setup","description":"For complete Android setup instructions including Google Play Console configuration, app setup, and testing guidelines, please visit:","source":"@site/docs/getting-started/setup-android.md","sourceDirName":"getting-started","slug":"/getting-started/setup-android","permalink":"/react-native-iap/docs/getting-started/setup-android","draft":false,"unlisted":false,"editUrl":"https://github.com/hyochan/react-native-iap/tree/main/docs/docs/getting-started/setup-android.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"iOS Setup","permalink":"/react-native-iap/docs/getting-started/setup-ios"},"next":{"title":"Horizon OS","permalink":"/react-native-iap/docs/getting-started/setup-horizon"}}');var i=r(74848),t=r(28453),o=r(35159);const c={sidebar_position:2},d="Android Setup",l={},a=[{value:"App Configuration",id:"app-configuration",level:2},{value:"Code Integration",id:"code-integration",level:2},{value:"Basic Setup",id:"basic-setup",level:3},{value:"Android-Specific Product Handling",id:"android-specific-product-handling",level:3},{value:"Android-Specific Subscription Handling",id:"android-specific-subscription-handling",level:3},{value:"Error Handling for Android",id:"error-handling-for-android",level:3},{value:"Common Issues",id:"common-issues",level:2},{value:"Product IDs Not Found",id:"product-ids-not-found",level:3},{value:"Testing Issues",id:"testing-issues",level:3},{value:"Purchase Flow Issues",id:"purchase-flow-issues",level:3},{value:"Subscription Issues",id:"subscription-issues",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Next Steps",id:"next-steps",level:2}];function u(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"android-setup",children:"Android Setup"})}),"\n",(0,i.jsx)(o.A,{}),"\n",(0,i.jsx)(n.p,{children:"For complete Android setup instructions including Google Play Console configuration, app setup, and testing guidelines, please visit:"}),"\n",(0,i.jsxs)(n.p,{children:["\ud83d\udc49 ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"https://openiap.dev/docs/android-setup",children:"Android Setup Guide - openiap.dev"})})]}),"\n",(0,i.jsx)(n.p,{children:"The guide covers:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Google Play Console configuration"}),"\n",(0,i.jsx)(n.li,{children:"App bundle setup and signing"}),"\n",(0,i.jsx)(n.li,{children:"Testing with internal testing tracks"}),"\n",(0,i.jsx)(n.li,{children:"Common troubleshooting steps"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"app-configuration",children:"App Configuration"}),"\n",(0,i.jsx)(n.p,{children:"React Native IAP automatically handles most Android configuration. The required billing permissions and dependencies are included automatically."}),"\n",(0,i.jsx)(n.h2,{id:"code-integration",children:"Code Integration"}),"\n",(0,i.jsx)(n.h3,{id:"basic-setup",children:"Basic Setup"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"import {useIAP, ErrorCode} from 'react-native-iap';\n\nconst androidProductIds = [\n  'premium_upgrade',\n  'coins_100',\n  'monthly_subscription',\n];\n\nfunction App() {\n  const {connected, products, subscriptions, fetchProducts, requestPurchase} =\n    useIAP({\n      onPurchaseSuccess: (purchase) => {\n        console.log('Purchase successful:', purchase);\n        handleSuccessfulPurchase(purchase);\n      },\n      onPurchaseError: (error) => {\n        console.error('Purchase failed:', error);\n        handlePurchaseError(error);\n      },\n    });\n\n  React.useEffect(() => {\n    if (connected) {\n      // Fetch products and subscriptions\n      fetchProducts({\n        skus: androidProductIds.filter((id) => !id.includes('subscription')),\n        type: 'in-app',\n      });\n      fetchProducts({\n        skus: androidProductIds.filter((id) => id.includes('subscription')),\n        type: 'subs',\n      });\n    }\n  }, [connected]);\n\n  return (\n    <View>\n      {/* Render products */}\n      {products.map((product) => (\n        <AndroidProductItem key={product.id} product={product} />\n      ))}\n\n      {/* Render subscriptions */}\n      {subscriptions.map((subscription) => (\n        <AndroidSubscriptionItem\n          key={subscription.id}\n          subscription={subscription}\n        />\n      ))}\n    </View>\n  );\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"android-specific-product-handling",children:"Android-Specific Product Handling"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"const AndroidProductItem = ({product}: {product: Product}) => {\n  const {requestPurchase} = useIAP();\n\n  const handlePurchase = () => {\n    if (product.platform === 'android') {\n      requestPurchase({\n        request: {\n          google: {skus: [product.id]},\n        },\n        type: 'in-app',\n      });\n    }\n  };\n\n  if (product.platform !== 'android') return null;\n\n  return (\n    <TouchableOpacity onPress={handlePurchase}>\n      <Text>{product.title}</Text>\n      <Text>{product.oneTimePurchaseOfferDetails?.formattedPrice}</Text>\n    </TouchableOpacity>\n  );\n};\n"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\ud83d\udca1 Cross-Platform Note:"})," This example shows Android-specific usage with ",(0,i.jsx)(n.code,{children:"google.skus"}),". For cross-platform compatibility, include both ",(0,i.jsx)(n.code,{children:"apple"})," and ",(0,i.jsx)(n.code,{children:"google"})," in your request object. See the ",(0,i.jsx)(n.a,{href:"/docs/api/methods/core-methods#requestpurchase",children:"Core Methods"})," documentation for details."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"android-specific-subscription-handling",children:"Android-Specific Subscription Handling"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"const AndroidSubscriptionItem = ({\n  subscription,\n}: {\n  subscription: ProductSubscription;\n}) => {\n  const {requestPurchase} = useIAP();\n\n  const handleSubscribe = (offer: any) => {\n    if (subscription.platform === 'android') {\n      requestPurchase({\n        request: {\n          google: {\n            skus: [subscription.id],\n            subscriptionOffers: [\n              {\n                sku: subscription.id,\n                offerToken: offer.offerToken,\n              },\n            ],\n          },\n        },\n        type: 'subs',\n      });\n    }\n  };\n\n  if (subscription.platform !== 'android') return null;\n\n  return (\n    <View>\n      <Text>{subscription.title}</Text>\n      {subscription.subscriptionOfferDetailsAndroid?.map((offer) => (\n        <TouchableOpacity\n          key={offer.offerId}\n          onPress={() => handleSubscribe(offer)}\n        >\n          <Text>\n            {offer.pricingPhases.pricingPhaseList\n              .map((phase) => `${phase.formattedPrice}/${phase.billingPeriod}`)\n              .join(' then ')}\n          </Text>\n        </TouchableOpacity>\n      ))}\n    </View>\n  );\n};\n"})}),"\n",(0,i.jsx)(n.h3,{id:"error-handling-for-android",children:"Error Handling for Android"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"const handleAndroidError = (error: PurchaseError) => {\n  switch (error.code) {\n    case ErrorCode.UserCancelled:\n      // User cancelled - no action needed\n      break;\n    case ErrorCode.ItemUnavailable:\n      Alert.alert(\n        'Product Unavailable',\n        'This item is not available for purchase',\n      );\n      break;\n    case ErrorCode.ServiceError:\n      Alert.alert('Service Error', 'Google Play services are unavailable');\n      break;\n    case ErrorCode.DeveloperError:\n      Alert.alert('Configuration Error', 'Please contact support');\n      break;\n    default:\n      Alert.alert('Purchase Failed', error.message);\n  }\n};\n"})}),"\n",(0,i.jsx)(n.h2,{id:"common-issues",children:"Common Issues"}),"\n",(0,i.jsx)(n.h3,{id:"product-ids-not-found",children:"Product IDs Not Found"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem"}),": Products return empty or show as unavailable ",(0,i.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Verify product IDs match exactly between code and Play Console"}),"\n",(0,i.jsxs)(n.li,{children:["Ensure products are ",(0,i.jsx)(n.strong,{children:"Active"})," in Play Console"]}),"\n",(0,i.jsx)(n.li,{children:"Check that app is uploaded to at least Internal testing track"}),"\n",(0,i.jsx)(n.li,{children:"Verify the app package name matches"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"testing-issues",children:"Testing Issues"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem"}),': "Item not found" or "Authentication required" errors ',(0,i.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use Gmail accounts added as test users"}),"\n",(0,i.jsx)(n.li,{children:"Install app from testing track, not directly via ADB"}),"\n",(0,i.jsx)(n.li,{children:"Ensure test user has a valid payment method"}),"\n",(0,i.jsx)(n.li,{children:"Clear Google Play Store cache and data"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"purchase-flow-issues",children:"Purchase Flow Issues"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem"}),": Purchase dialog doesn't appear or fails immediately ",(0,i.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Verify Google Play services are updated"}),"\n",(0,i.jsx)(n.li,{children:"Check device has valid Google account"}),"\n",(0,i.jsx)(n.li,{children:"Ensure app is properly signed"}),"\n",(0,i.jsx)(n.li,{children:"Test on different devices"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"subscription-issues",children:"Subscription Issues"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem"}),": Subscription offers not showing or failing ",(0,i.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Verify base plans are properly configured"}),"\n",(0,i.jsx)(n.li,{children:"Check offer eligibility rules"}),"\n",(0,i.jsx)(n.li,{children:"Ensure proper offer token handling"}),"\n",(0,i.jsx)(n.li,{children:"Test with different user accounts"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Always test on real devices"})," - emulators may have issues with Google Play services"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use proper product IDs"})," - follow reverse domain naming (com.yourapp.product)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Handle all error cases"})," - especially network and service errors"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Test with multiple accounts"})," - verify behavior for new and existing users"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Implement proper retry logic"})," - for transient failures"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"./installation",children:"Review the installation guide"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"./setup-ios",children:"Explore iOS setup"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"../api/error-codes",children:"Understand error codes"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},27856:(e,n,r)=>{r.d(n,{I:()=>i,V:()=>s});const s="https://iapkit.com",i="https://www.hyo.dev/api/ad-banner/cmjf0l2460003249hfyh029dm"},28453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>c});var s=r(96540);const i={},t=s.createContext(i);function o(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(t.Provider,{value:n},e.children)}},35159:(e,n,r)=>{r.d(n,{A:()=>c});var s=r(96540),i=r(86025),t=r(27856),o=r(74848);function c({className:e="iapkit-banner",style:n}){const r=(0,i.Ay)("/img/iapkit-banner.gif"),c=(0,s.useCallback)(e=>{fetch(t.I,{method:"POST",mode:"no-cors"}).catch(()=>{})},[]);return(0,o.jsx)("div",{className:e,style:{marginTop:0,marginBottom:12,textAlign:"center",...n},children:(0,o.jsx)("a",{href:t.V,target:"_blank",rel:"noopener noreferrer",onClick:c,style:{display:"inline-block",textDecoration:"none"},children:(0,o.jsx)("img",{src:r,alt:"IapKit - In-App Purchase Validation Service",style:{border:"none",display:"block"}})})})}}}]);